= Oauth2 Policy

ifdef::env-github[]
image:https://ci.gravitee.io/buildStatus/icon?job=gravitee-io/gravitee-policy-oauth2/master["Build status", link="https://ci.gravitee.io/job/gravitee-io/job/gravitee-policy-oauth2/"]
image:https://badges.gitter.im/Join Chat.svg["Gitter", link="https://gitter.im/gravitee-io/gravitee-io?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge"]
endif::[]

== Scope

|===
|onRequest |onResponse

| X
|

|===

== Description

Gravitee.io OAuth 2 policy authentication. Check if an OAuth 2 access token is valid during the request process.

If the access token is valid, the request is allowed to proceed, if not the process stops and reject the request.

The access token must be supply in the Authorization HTTP request header :

[source]
----
$ curl -H "Authorization: Bearer |accessToken|" \
           http://gravitee.io-gateway/yourApi/yourRestrictedData
----

== Configuration

The policy use the following Gravitee.io OAuth 2.0 resource properties :

[source, json]
.Gravitee.io OAuth2 Resource
----
 "properties" : {
    "serverURL" : {
      "title": "Server URL",
      "description": "OAuth2 Server URL.",
      "type" : "string"
    },
    "httpMethod" : {
      "title": "HTTP Method",
      "description": "HTTP method used to validate the OAuth token.",
      "type" : "string",
      "enum": [
        "GET",
        "POST"
      ],
      "default": "GET"
    },
    "secure" : {
      "title": "Secure",
      "description": "HTTP / HTTPS",
      "type" : "boolean",
      "default": false
    },
    "authorizationHeaderName" : {
      "type" : "string",
      "title": "Authorization header",
      "default": "Authorization"
    },
    "authorizationScheme" : {
      "type" : "string",
      "title": "Authorization scheme",
      "default": "Basic"
    },
    "authorizationValue" : {
      "title": "Authorization value",
      "type" : "string"
    },
    "tokenIsSuppliedByQueryParam" : {
      "title": "Token from HTTP query parameter",
      "description": "Does the OAuth token is supplied using a query parameter ?",
      "type" : "boolean",
      "default": true
    },
    "tokenQueryParamName" : {
      "title": "Query param name",
      "description": "Query parameter used to supply OAuth token",
      "type" : "string",
      "default": "token"
    },
    "tokenIsSuppliedByHttpHeader" : {
      "title": "Token from HTTP header",
      "description": "Does the OAuth token is supplied using an HTTP header ?",
      "type" : "boolean",
      "default": false
    },
    "tokenHeaderName" : {
      "description": "HTTP header used to supply OAuth token",
      "title": "HTTP header name",
      "type" : "string"
    }
  },
  "required": [
    "serverURL",
    "httpMethod",
    "isSecure"
  ]
----

[source, json]
.Sample
----
"oauth2": {
  "oauthResource": {}
}
----